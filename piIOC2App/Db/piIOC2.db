#################################################
# ###                                       ### #
# ### Epics database for	            ### #
# ### PI - Pollux	                    ### #
# ###                                       ### #
# ### author: D. Hampai - M. Montis         ### #
# ###                                       ### #
# ### Ref 1.0; 2025-08-27                   ### #
#################################################
#
record(stringin, "$(MOT):model") {
	field(DESC, "Device Version $(axis)")
	field(SCAN, "Passive")
	field(DTYP, "stream")
	field(INP, "@piIOC2.proto getModel($(axis)) $(ASYNPORT)")
	field(PINI, "YES")
}
#record(ai, "$(MOT):err_$(axis)") {
record(stringin, "$(MOT):err_$(card)_$(axis)") {
        field(DESC, "Get Error $(axis)")
        field(SCAN, "Passive")
        field(DTYP, "stream")
        field(INP, "@piIOC2.proto getError($(axis)) $(ASYNPORT)")
        field(PINI, "YES")
}
#
#	POS
#
record(bo, "$(MOT):reqpos_$(card)_$(axis)") {
	field(DESC, "Request Position $(card)_$(axis)")
	field(FLNK, "$(MOT):evalpos_$(card)_$(axis)")	
        field(PINI, "YES")
}
record(ai, "$(MOT):pos_$(card)_$(axis)") {
        field(DESC, "Get Position $(card)_$(axis)")
	field(EGU, "$(EGU)")
        field(SCAN, "Passive")
        field(DTYP, "stream")
        field(INP, "@piIOC2.proto getPos($(axis)) $(ASYNPORT)")
#	field(PREC, "3")
        field(PINI, "NO")
}
record(seq, "$(MOT):evalpos_$(card)_$(axis)") {
	field(DO0, "1")
        field(LNK0, "$(MOT):err_$(card)_$(axis)")
	field(DOL1, "1")
        field(LNK1, "$(MOT):pos_$(card)_$(axis).PROC")
}
#
#	Status Motor
#
record(bo, "$(MOT):reqstatus_$(card)_$(axis)") {
        field(DESC, "Request Status $(card)_$(axis)")
        field(FLNK, "$(MOT):evalstatus_$(card)_$(axis)")
	field(ZNAM, "0")  # Label for state 0
	field(ONAM, "1")  # Label for state 1
        field(PINI, "YES")
}
record(stringin, "$(MOT):ori_status_$(card)_$(axis)") {
        field(DESC, "Get Status $(card)_$(axis)")
        field(SCAN, "Passive")
        field(DTYP, "stream")
        field(INP, "@piIOC2.proto getStatus($(card),$(axis)) $(ASYNPORT)")
        field(PINI, "NO")
	field(FLNK, "$(MOT):status_$(card)_$(axis)")
}
record(stringin, "$(MOT):term_status_$(card)_$(axis)") {
	field(DESC, "Terminator for Motor Status")
	field(VAL, "$(onoff)")
	field(PINI, "YES")
}
record(scalcout, "$(MOT):status_$(card)_$(axis)") {
	field(DESC, "Extract Info On/Off")
	field(INAA, "$(MOT):ori_status_$(card)_$(axis)")
	field(INBB, "$(MOT):term_status_$(card)_$(axis)")
	field(CALC, "AA=BB?1:0")
}
record(seq, "$(MOT):evalstatus_$(card)_$(axis)") {
        field(DO0, "1")
        field(LNK0, "$(MOT):err_$(card)_$(axis)")
        field(DOL1, "1")
        field(LNK1, "$(MOT):ori_status_$(card)_$(axis).PROC")
}
#record(bo, "$(MOT):reqstatus_$(card)_$(axis)") {
#        field(DESC, "Request Status $(card)_$(axis)")
#        field(FLNK, "$(MOT):evalstatus_$(card)_$(axis)")
#	field(ZNAM, "0")  # Label for state 0
#	field(ONAM, "1")  # Label for state 1
#        field(PINI, "YES")
#}
##record(bi, "$(MOT):status_$(card)_$(axis)") {
#record(stringin, "$(MOT):status_$(card)_$(axis)") {
#        field(DESC, "Get Status $(card)_$(axis)")
#        field(SCAN, "Passive")
#        field(DTYP, "stream")
##        field(ZNAM, "0")  # Label for state 0
##        field(ONAM, "1")  # Label for state 1
#        field(INP, "@piIOC2.proto getStatus($(axis)) $(ASYNPORT)")
#        field(PINI, "NO")
#}
#record(seq, "$(MOT):evalstatus_$(card)_$(axis)") {
#        field(DO0, "1")
#        field(LNK0, "$(MOT):err_$(card)_$(axis)")
#        field(DOL1, "1")
#        field(LNK1, "$(MOT):status_$(card)_$(axis).PROC")
#}
#
#       ON/OFF Motor
#
record(bo, "$(MOT):reqmotor_$(card)_$(axis)") {
        field(DESC, "Request On/Off Motor $(card)_$(axis)")
        field(FLNK, "$(MOT):evalmotor_$(card)_$(axis)")
        field(ZNAM, "0")  # Label for state 0
        field(ONAM, "1")  # Label for state 1
}
record(bo, "$(MOT):motor_$(card)_$(axis)") {
        field(DESC, "On/Off Motor $(card)_$(axis)")
        field(SCAN, "Passive")
        field(DTYP, "stream")
        field(ZNAM, "0")  # Label for state 0
        field(ONAM, "1")  # Label for state 1
        field(OUT, "@piIOC2.proto setStatus($(axis)) $(ASYNPORT)")
        field(PINI, "NO")
}
record(seq, "$(MOT):evalmotor_$(card)_$(axis)") {
        field(DO0, "1")
        field(LNK0, "$(MOT):err_$(card)_$(axis)")
        field(DOL1, "$(MOT):reqmotor_$(card)_$(axis).VAL")
        field(LNK1, "$(MOT):motor_$(card)_$(axis)")
        field(DO2, "1")
        field(LNK2, "$(MOT):motor_$(card)_$(axis).PROC")
        field(DLY2, "1")
        field(DO3, "1")
        field(LNK3, "$(MOT):err_$(card)_$(axis)")
        field(DO4, "1")
        field(LNK4, "$(MOT):status_$(card)_$(axis).PROC")
}
#
#       Status Moving
#
record(bo, "$(MOT):reqmoving_$(card)_$(axis)") {
        field(DESC, "Request Status Moving $(card)_$(axis)")
        field(FLNK, "$(MOT):evalmoving_$(card)_$(axis)")
        field(ZNAM, "0")  # Label for state 0
        field(ONAM, "1")  # Label for state 1
}
record(stringin, "$(MOT):ori_moving_$(card)_$(axis)") {
	field(DESC, "Get Status Moving $(card)_$(axis)")
	field(SCAN, "Passive")
	field(DTYP, "stream")
	field(INP, "@piIOC2.proto getMoving($(card),$(axis)) $(ASYNPORT)")
	field(PINI, "NO")
	field(FLNK, "$(MOT):moving_$(card)_$(axis)")
}
record(stringin, "$(MOT):term_moving_$(card)_$(axis)") {
	field(DESC, "Terminator for Motor Moving")
	field(VAL, "$(ready)")
	field(PINI, "YES")
}
record(scalcout, "$(MOT):moving_$(card)_$(axis)") {
	field(DESC, "Extract Moving")
	field(INAA, "$(MOT):ori_moving_$(card)_$(axis)")
	field(INBB, "$(MOT):term_moving_$(card)_$(axis)")
	field(CALC, "AA=BB?1:0")
}
record(seq, "$(MOT):evalmoving_$(card)_$(axis)") {
	field(DO0, "1")
	field(LNK0, "$(MOT):err_$(card)_$(axis)")
	field(DOL1, "1")
	field(LNK1, "$(MOT):ori_moving_$(card)_$(axis).PROC")
}
#record(bo, "$(MOT):reqmoving_$(card)_$(axis)") {
#        field(DESC, "Request Status Moving $(card)_$(axis)")
#        field(FLNK, "$(MOT):evalmoving_$(card)_$(axis)")
#        field(ZNAM, "0")  # Label for state 0
#        field(ONAM, "1")  # Label for state 1
#}
##record(bi, "$(MOT):moving_$(card)_$(axis)") {
#record(stringin, "$(MOT):moving_$(card)_$(axis)") {
#        field(DESC, "Get Status Moving $(card)_$(axis)")
#        field(SCAN, "Passive")
#        field(DTYP, "stream")
##        field(ZNAM, "0")  # Label for state 0
##        field(ONAM, "1")  # Label for state 1
#        field(INP, "@piIOC2.proto getMoving($(axis)) $(ASYNPORT)")
#        field(PINI, "NO")
#}
#record(seq, "$(MOT):evalmoving_$(card)_$(axis)") {
#        field(DO0, "1")
#        field(LNK0, "$(MOT):err_$(card)_$(axis)")
#        field(DOL1, "1")
#        field(LNK1, "$(MOT):moving_$(card)_$(axis).PROC")
#}
#
#	MOVE ABSOLUTE
#
record(ao, "$(MOT):setma_$(card)_$(axis)") {
	field(DESC, "Set Move Absolute $(card)_$(axis)")
	field(FLNK, "$(MOT):evalma_$(card)_$(axis)")
	field(PINI, "NO")
}
record(ao, "$(MOT):ma_$(card)_$(axis)") {
	field(DESC, "Move Absolute $(card)_$(axis)")
	field(SCAN, "Passive")
        field(DTYP, "stream")
        field(OUT, "@piIOC2.proto setMovAbs($(axis)) $(ASYNPORT)")
        field(PINI, "NO")
}
record(seq,"$(MOT):evalma_$(card)_$(axis)") {
	field(DO0, "1")
        field(LNK0, "$(MOT):err_$(card)_$(axis)")
	field(DOL1, "$(MOT):setma_$(card)_$(axis).VAL")
        field(LNK1, "$(MOT):ma_$(card)_$(axis)")
	field(DO2, "1")
        field(LNK2, "$(MOT):ma_$(card)_$(axis).PROC")
	field(DLY2, "1")
	field(DO3, "1")
        field(LNK3, "$(MOT):err_$(card)_$(axis)")
	field(DO4, "1")
        field(LNK4, "$(MOT):pos_$(card)_$(axis).PROC")
}
#
#       MOVE RELATIVE
#
record(ao, "$(MOT):setmr_$(card)_$(axis)") {
        field(DESC, "Set Move Relative $(card)_$(axis)")
        field(FLNK, "$(MOT):evalmr_$(card)_$(axis)")
        field(PINI, "NO")
}
record(ao, "$(MOT):mr_$(card)_$(axis)") {
        field(DESC, "Move Relative $(card)_$(axis)")
        field(SCAN, "Passive")
        field(DTYP, "stream")
        field(OUT, "@piIOC2.proto setMovRel($(axis)) $(ASYNPORT)")
        field(PINI, "NO")
}
record(seq,"$(MOT):evalmr_$(card)_$(axis)") {
        field(DO0, "1")
        field(LNK0, "$(MOT):err_$(card)_$(axis)")
        field(DOL1, "$(MOT):setmr_$(card)_$(axis).VAL")
        field(LNK1, "$(MOT):mr_$(card)_$(axis)")
        field(DO2, "1")
        field(LNK2, "$(MOT):mr_$(card)_$(axis).PROC")
        field(DLY2, "1")
        field(DO3, "1")
        field(LNK3, "$(MOT):err_$(card)_$(axis)")
        field(DO4, "1")
        field(LNK4, "$(MOT):pos_$(card)_$(axis).PROC")
}
#
#	Initialization
#
record(bo, "$(MOT):reqinit_$(card)_$(axis)") {
        field(DESC, "Request Initialization $(card)_$(axis)")
        field(FLNK, "$(MOT):evalinit_$(card)_$(axis)")
        field(ZNAM, "0")  # Label for state 0
        field(ONAM, "1")  # Label for state 1
}
record(ai, "$(MOT):init_$(card)_$(axis)") {
        field(DESC, "Initialization $(card)_$(axis)")
        field(SCAN, "Passive")
        field(DTYP, "stream")
        field(INP, "@piIOC2.proto setInit($(axis),$(homing)) $(ASYNPORT)")
        field(PINI, "NO")
}
record(seq, "$(MOT):evalinit_$(card)_$(axis)") {
        field(DO0, "1")
        field(LNK0, "$(MOT):err_$(card)_$(axis)")
        field(DOL1, "1")
        field(LNK1, "$(MOT):init_$(card)_$(axis).PROC")
}
#
#       homing
#
record(bo, "$(MOT):reqhome_$(card)_$(axis)") {
        field(DESC, "Request Homing $(card)_$(axis)")
        field(FLNK, "$(MOT):evalhome_$(card)_$(axis)")
        field(ZNAM, "0")  # Label for state 0
        field(ONAM, "1")  # Label for state 1
}
record(ai, "$(MOT):home_$(card)_$(axis)") {
        field(DESC, "Homing $(card)_$(axis)")
        field(SCAN, "Passive")
        field(DTYP, "stream")
#        field(INP, "@piIOC2.proto setHoming($(axis)) $(ASYNPORT)")
        field(INP, "@piIOC2.proto setInit($(axis),$(homing)) $(ASYNPORT)")
        field(PINI, "NO")
}
record(seq, "$(MOT):evalhome_$(card)_$(axis)") {
        field(DO0, "1")
        field(LNK0, "$(MOT):err_$(card)_$(axis)")
        field(DOL1, "1")
        field(LNK1, "$(MOT):home_$(card)_$(axis).PROC")
}



